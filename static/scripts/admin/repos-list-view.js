define(["libs/toastr","admin/repos-row-view","admin/repos-model"],function(a,b,c){var d=Backbone.View.extend({el:"#center",rowViews:{},defaults:{filter:"with_tools",sort_by:"date",sort_order:"asc"},events:{"click #select-all-checkboxes":"selectAll","click th > a":"sortClicked"},initialize:function(a){this.options=_.defaults(this.options||{},a,this.defaults),this.collection=new c.Repos,this.listenTo(this.collection,"sync",this.renderAll),this.collection.switchComparator(this.options.sort_by),this.render(),this.fetchRepos(),this.repaint()},render:function(a){this.options=_.extend(this.options,a);var b=this.templateRepoList();this.$el.html(b()),$("#center").css("overflow","auto"),this.$el.find("[data-toggle]").tooltip()},fetchRepos:function(){this.collection.fetch({success:function(){},error:function(){}})},repaint:function(a){this.options=_.extend(this.options,a),this.removeAllRows(),this.adjustMenu(),this.renderAll()},adjustMenu:function(a){this.options=_.extend(this.options,a),this.$el.find("li").removeClass("active"),$(".tab_"+this.options.filter).addClass("active")},updateRepoCounts:function(a){this.options=_.extend(this.options,a)},renderAll:function(a){this.options=_.extend(this.options,a),this.collection.switchComparator(this.options.sort_by),this.collection.sort();var b="desc"===this.options.sort_order?this.collection.models.reverse():this.collection.models,c=this;_.each(b,function(a){c.renderOne(a)})},renderOne:function(a){var c=null;("all"===this.options.filter||this.options.filter===a.get("type"))&&(this.rowViews[a.get("id")]?c=this.rowViews[a.get("id")].render():(c=new b.AdminReposRowView({repo:a}),this.rowViews[a.get("id")]=c),this.$el.find("#repos_list_body").append(c.el),this.$el.find("[data-toggle]").tooltip())},removeOne:function(){},removeAllRows:function(){var a=this;this.$el.find(".repo-row").each(function(){var b=$(this).data("id");a.rowViews[b].remove()})},selectAll:function(a){var b=a.target.checked;that=this,$(":checkbox","#repos_list_body").each(function(){this.checked=b,view_id=$(this.parentElement.parentElement).data("id"),b?that.rowViews[view_id].turnDark():that.rowViews[view_id].turnLight()})},sortClicked:function(a){this.adjustHeading(a),this.removeAllRows(),this.renderAll()},adjustHeading:function(a){var b=$(a.target).attr("class").split("-")[2];b===this.options.sort_by&&(this.options.sort_order="asc"===this.options.sort_order?"desc":"asc"),this.options.sort_by=b,this.$el.find('span[class^="sort-icon"]').hide().removeClass("fa-sort-asc").removeClass("fa-sort-desc"),this.$el.find(".sort-icon-"+b).addClass("fa-sort-"+this.options.sort_order).show()},templateRepoList:function(){return _.template(['<div class="library_style_container">','<div class="repos_toolbar">',"<span><strong>REPOSITORIES</strong></span>",'<button data-toggle="tooltip" data-placement="top" title="Uninstall selected repositories" class="btn btn-default primary-button toolbar-item" type="button">',"Uninstall","</button>",'<button data-toggle="tooltip" data-placement="top" title="Update selected repositories" class="btn btn-default primary-button toolbar-item" type="button">',"Update","</button>",'<ul class="nav nav-tabs repos-nav">','<li role="presentation" class="tab_all"><a href="#all">All</a></li>','<li role="presentation" class="tab_with_tools"><a href="#repos">With Tools</a></li>','<li role="presentation" class="tab_packages"><a href="#packages">Packages</a></li>','<li role="presentation" class="tab_suites"><a href="#">Suites</a></li>','<li role="presentation" class="tab_with_dm"><a href="#">Data Managers</a></li>','<li role="presentation" class="tab_with_datatypes"><a href="#">Datatypes</a></li>',"</ul>","</div>",'<div id="repositories_list">','<div class="repos_container table-responsive">','<table class="grid table table-condensed">',"<thead>",'<th style="text-align: center; width: 20px; " title="Check to select all repositories"><input id="select-all-checkboxes" style="margin: 0;" type="checkbox"></th>',"<th>",'<a class="sort-repos-name" data-toggle="tooltip" data-placement="top" title="alphabetically" href="#">',"Name","</a>",'<span class="sort-icon-name fa fa-sort-asc" style="display: none;"/>',"</th>","<th>",'<a class="sort-repos-owner" data-toggle="tooltip" data-placement="top" title="alphabetically" href="#">',"Owner","</a>",'<span class="sort-icon-owner fa fa-sort-asc" style="display: none;"/>',"</th>","<th>",'<a class="sort-repos-installation" data-toggle="tooltip" data-placement="top" title="erroneous first" href="#">',"Installation","</a>",'<span class="sort-icon-installation fa fa-sort-asc" style="display: none;"/>',"</th>","<th>",'<a class="sort-repos-category" data-toggle="tooltip" data-placement="top" title="alphabetically" href="#">',"Category","</a>",'<span class="sort-icon-category fa fa-sort-asc" style="display: none;"/>',"</th>","<th>",'<a class="sort-repos-version" data-toggle="tooltip" data-placement="top" title="outdated first" href="#">',"Version","</a>",'<span class="sort-icon-version fa fa-sort-asc" style="display: none;"/>',"</th>","<th>",'<a class="sort-repos-date" data-toggle="tooltip" data-placement="top" title="newest first" href="#">',"Date Installed","</a>",'<span class="sort-icon-date fa fa-sort-asc"/>',"</th>","</thead>",'<tbody id="repos_list_body">',"</tbody>","</table>","</div>","</div>","</div>"].join(""))}});return{AdminReposListView:d}});
//# sourceMappingURL=../../maps/admin/repos-list-view.js.map