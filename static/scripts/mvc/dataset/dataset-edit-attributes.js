define(["utils/utils","mvc/ui/ui-tabs","mvc/ui/ui-misc","mvc/form/form-view"],function(a,b,c,d){var e=Backbone.View.extend({initialize:function(){this.setElement("<div/>"),this.model=new Backbone.Model({dataset_id:Galaxy.params.dataset_id}),this.message=new c.Message({persistent:!0}),this.tabs=this._createTabs(),this.$el.append($("<h4/>").append("Edit dataset attributes")).append(this.message.$el).append("<p/>").append(this.tabs.$el).hide(),this.render()},render:function(){var a=this;$.ajax({url:Galaxy.root+"dataset/get_edit?dataset_id="+a.model.get("dataset_id"),success:function(b){!a.initial_message&&a.message.update(b),a.initial_message=!0,_.each(a.forms,function(a,c){a.model.set("inputs",b[c+"_inputs"]),a.model.set("hide_operations",b[c+"_disable"]),a.render()}),a.$el.show()},error:function(b){var c=b.responseJSON&&b.responseJSON.err_msg;a.message.update({status:"danger",message:c||"Error occured while loading the dataset."})}})},_submit:function(a,b){var c=this,d=b.data.create();d.dataset_id=this.model.get("dataset_id"),d.operation=a,$.ajax({type:"PUT",url:Galaxy.root+"dataset/set_edit",data:d,success:function(a){c.message.update(a),c.render(),c._reloadHistory()},error:function(a){var b=a.responseJSON&&a.responseJSON.err_msg;c.message.update({status:"danger",message:b||"Error occured while editing the dataset attributes."})}})},_createTabs:function(){this.forms={attribute:this._getAttribute(),conversion:this._getConversion(),datatype:this._getDatatype(),permission:this._getPermission()};var a=new b.View;return a.add({id:"attribute",title:"Attributes",icon:"fa fa-bars",tooltip:"Edit dataset attributes",$el:this.forms.attribute.$el}),a.add({id:"convert",title:"Convert",icon:"fa-gear",tooltip:"Convert to new format",$el:this.forms.conversion.$el}),a.add({id:"datatype",title:"Datatypes",icon:"fa-database",tooltip:"Change data type",$el:this.forms.datatype.$el}),a.add({id:"permissions",title:"Permissions",icon:"fa-user",tooltip:"Permissions",$el:this.forms.permission.$el}),a},_getAttribute:function(){var a=this,b=new d({title:"Edit attributes",operations:{submit_attributes:new c.ButtonIcon({tooltip:"Save attributes of the dataset.",icon:"fa-floppy-o",title:"Save",onclick:function(){a._submit("attributes",b)}}),submit_autodetect:new c.ButtonIcon({tooltip:"This will inspect the dataset and attempt to correct the values of fields if they are not accurate.",icon:"fa-undo",title:"Auto-detect",onclick:function(){a._submit("autodetect",b)}})}});return b},_getConversion:function(){var a=this,b=new d({title:"Convert to new format",operations:{submit_conversion:new c.ButtonIcon({tooltip:"Convert the datatype to a new format.",title:"Convert datatype",icon:"fa-exchange",onclick:function(){a._submit("conversion",b)}})}});return b},_getDatatype:function(){var a=this,b=new d({title:"Change datatype",operations:{submit_datatype:new c.ButtonIcon({tooltip:"Change the datatype to a new type.",title:"Change datatype",icon:"fa-exchange",onclick:function(){a._submit("datatype",b)}})}});return b},_getPermission:function(){var a=this,b=new d({title:"Manage dataset permissions",operations:{submit_permission:new c.ButtonIcon({tooltip:"Save permissions.",title:"Save permissions",icon:"fa-floppy-o ",onclick:function(){a._submit("permission",b)}})}});return b},_reloadHistory:function(){window.Galaxy&&window.Galaxy.currHistoryPanel.loadCurrentHistory()}});return{View:e}});
//# sourceMappingURL=../../../maps/mvc/dataset/dataset-edit-attributes.js.map