"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ListOfListsDatasetCollection=exports.ListPairedDatasetCollection=exports.PairDatasetCollection=exports.ListDatasetCollection=void 0;var _datasetModel=require("mvc/dataset/dataset-model"),_datasetModel2=_interopRequireDefault(_datasetModel),_baseMvc=require("mvc/base-mvc"),_baseMvc2=_interopRequireDefault(_baseMvc),_localization=require("utils/localization"),_localization2=_interopRequireDefault(_localization),DatasetCollectionElementMixin={defaults:{model_class:"DatasetCollectionElement",element_identifier:null,element_index:null,element_type:null},_mergeObject:function(t){return _.extend(t,t.object,{element_id:t.id}),delete t.object,t},constructor:function(t,e){t=this._mergeObject(t),this.idAttribute="element_id",Backbone.Model.apply(this,arguments)},parse:function(t,e){var i=t;return i=this._mergeObject(i)}},DatasetCollectionElement=Backbone.Model.extend(_baseMvc2.default.LoggableMixin).extend(DatasetCollectionElementMixin).extend({_logNamespace:"collections"}),DCECollection=Backbone.Collection.extend(_baseMvc2.default.LoggableMixin).extend({_logNamespace:"collections",model:DatasetCollectionElement,toString:function(){return"DatasetCollectionElementCollection("+this.length+")"}}),DatasetDCE=_datasetModel2.default.DatasetAssociation.extend(_baseMvc2.default.mixin(DatasetCollectionElementMixin,{url:function(){return this.has("history_id")?Galaxy.root+"api/histories/"+this.get("history_id")+"/contents/"+this.get("id"):(console.warn("no endpoint for non-hdas within a collection yet"),Galaxy.root+"api/datasets")},defaults:_.extend({},_datasetModel2.default.DatasetAssociation.prototype.defaults,DatasetCollectionElementMixin.defaults),_downloadQueryParameters:function(){return"?to_ext="+this.get("file_ext")+"&hdca_id="+this.get("parent_hdca_id")+"&element_identifier="+this.get("element_identifier")},constructor:function(t,e){this.debug("\t DatasetDCE.constructor:",t,e),DatasetCollectionElementMixin.constructor.call(this,t,e)},hasDetails:function(){return this.elements&&this.elements.length},toString:function(){return["DatasetDCE(",this.get("element_identifier"),")"].join("")}})),DatasetDCECollection=DCECollection.extend({model:DatasetDCE,toString:function(){return["DatasetDCECollection(",this.length,")"].join("")}}),DatasetCollection=Backbone.Model.extend(_baseMvc2.default.LoggableMixin).extend(_baseMvc2.default.SearchableModelMixin).extend({_logNamespace:"collections",defaults:{collection_type:null,deleted:!1},collectionClass:DCECollection,initialize:function(t,e){this.debug(this+"(DatasetCollection).initialize:",t,e,this),this.elements=this._createElementsModel(),this.on("change:elements",function(){this.log("change:elements"),this.elements=this._createElementsModel()})},_createElementsModel:function(){this.debug(this+"._createElementsModel",this.collectionClass,this.get("elements"),this.elements);var t=this.get("elements")||[];this.unset("elements",{silent:!0});var e=this;return _.each(t,function(t,i){_.extend(t,{parent_hdca_id:e.get("id")})}),this.elements=new this.collectionClass(t),this.elements},toJSON:function(){var t=Backbone.Model.prototype.toJSON.call(this);return this.elements&&(t.elements=this.elements.toJSON()),t},inReadyState:function(){var t=this.get("populated");return this.isDeletedOrPurged()||t},hasDetails:function(){return 0!==this.elements.length},getVisibleContents:function(t){return this.elements},parse:function(t,e){var i=Backbone.Model.prototype.parse.call(this,t,e);return i.create_time&&(i.create_time=new Date(i.create_time)),i.update_time&&(i.update_time=new Date(i.update_time)),i},delete:function(t){return this.get("deleted")?jQuery.when():this.save({deleted:!0},t)},undelete:function(t){return!this.get("deleted")||this.get("purged")?jQuery.when():this.save({deleted:!1},t)},isDeletedOrPurged:function(){return this.get("deleted")||this.get("purged")},searchAttributes:["name","tags"],toString:function(){return"DatasetCollection("+[this.get("id"),this.get("name")||this.get("element_identifier")].join(",")+")"}}),ListDatasetCollection=DatasetCollection.extend({collectionClass:DatasetDCECollection,toString:function(){return"List"+DatasetCollection.prototype.toString.call(this)}}),PairDatasetCollection=ListDatasetCollection.extend({toString:function(){return"Pair"+DatasetCollection.prototype.toString.call(this)}}),NestedDCDCE=DatasetCollection.extend(_baseMvc2.default.mixin(DatasetCollectionElementMixin,{constructor:function(t,e){this.debug("\t NestedDCDCE.constructor:",t,e),DatasetCollectionElementMixin.constructor.call(this,t,e)},toString:function(){return["NestedDCDCE(",this.object?""+this.object:this.get("element_identifier"),")"].join("")}})),NestedDCDCECollection=DCECollection.extend({model:NestedDCDCE,toString:function(){return["NestedDCDCECollection(",this.length,")"].join("")}}),NestedPairDCDCE=PairDatasetCollection.extend(_baseMvc2.default.mixin(DatasetCollectionElementMixin,{constructor:function(t,e){this.debug("\t NestedPairDCDCE.constructor:",t,e),DatasetCollectionElementMixin.constructor.call(this,t,e)},toString:function(){return["NestedPairDCDCE(",this.object?""+this.object:this.get("element_identifier"),")"].join("")}})),NestedPairDCDCECollection=NestedDCDCECollection.extend({model:NestedPairDCDCE,toString:function(){return["NestedPairDCDCECollection(",this.length,")"].join("")}}),ListPairedDatasetCollection=DatasetCollection.extend({collectionClass:NestedPairDCDCECollection,toString:function(){return["ListPairedDatasetCollection(",this.get("name"),")"].join("")}}),NestedListDCDCE=ListDatasetCollection.extend(_baseMvc2.default.mixin(DatasetCollectionElementMixin,{constructor:function(t,e){this.debug("\t NestedListDCDCE.constructor:",t,e),DatasetCollectionElementMixin.constructor.call(this,t,e)},toString:function(){return["NestedListDCDCE(",this.object?""+this.object:this.get("element_identifier"),")"].join("")}})),NestedListDCDCECollection=NestedDCDCECollection.extend({model:NestedListDCDCE,toString:function(){return["NestedListDCDCECollection(",this.length,")"].join("")}}),ListOfListsDatasetCollection=DatasetCollection.extend({collectionClass:NestedListDCDCECollection,toString:function(){return["ListOfListsDatasetCollection(",this.get("name"),")"].join("")}});exports.ListDatasetCollection=ListDatasetCollection,exports.PairDatasetCollection=PairDatasetCollection,exports.ListPairedDatasetCollection=ListPairedDatasetCollection,exports.ListOfListsDatasetCollection=ListOfListsDatasetCollection;
//# sourceMappingURL=../../../maps/mvc/collection/collection-model.js.map
