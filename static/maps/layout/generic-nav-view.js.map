{"version":3,"sources":["layout/generic-nav-view.js"],"names":["define","Modal","GenericNavView","Backbone","View","extend","initialize","makeModalIframe","e","src","$el_chat_modal_header","$el_chat_modal_body","Galaxy","config","communication_server_host","query_string","window","communication_server_port","persistent_communication_rooms","$","length","remove","height","frame_height","width","closing_events","title_separator","cls","class_names","addClass","find","removeAttr","append","header_template","click","css","hasClass","removeClass","attr","frame_width","navItem","tooltip","id","icon","visible","onclick"],"mappings":"aACAA,QAAQ,mBAAoB,SAASC,GADrC,IAAAC,EAAAC,SAAAC,KAAAC,QACQC,WAAA,WACAJ,KAAAA,MAAiBC,MAMjBI,gBAAiB,SAASC,GAA1BD,IAQQE,EAAM,KACNC,EAAAA,KACAC,EAAAA,+DAVRJ,OAAiBK,OAAAC,OAAAC,0BAMTC,IALJC,OAAAJ,OAAAC,OAAAI,2BAIIC,aAHOF,OAAOJ,OAAOC,OAAOC,KAAAA,WAAAA,UAG5BI,mCAF4BD,OAAAA,OAAAA,OADhCJ,OAAAK,kCAAA,eAuEA,OAlDCC,EAAA,eAAAC,OAAA,GACDD,EAAA,eAAAE,SAGIC,EAAQC,MAAAA,IAF0BtB,EAAAG,MAGlCoB,KAAAA,EACAC,OAXc,IAYdC,MAbc,IAcdC,gBAAKC,EANTF,iBAAA,EAMIC,IAXJ,wBAiBAhB,EAAAA,MAAAA,OACAD,EAAAS,EAAA,6BACAT,EAAsBmB,EAAAA,2BAEtBnB,EAAsBoB,SAAtB,qBACApB,EAAAA,SAAsBqB,qBACtBrB,EAAsBsB,KAAAA,MAAOC,SAC7BvB,EAAAqB,WAAA,6BACAZ,EAAkBe,OAjCdD,uPAmCHd,EAFD,gBAAAe,MAAA,SAAA1B,GAGAW,EAAA,eAAAgB,IAAA,UAAA,UAGQhB,EAAAA,0BAAEe,MAAA,SAA6BV,GAC/BL,EAAE,0BAAFiB,SAAoC,cACpCjB,EAAE,6BACGkB,MAAAA,UAELlB,EAAE,2BAA0BmB,OAAK,SACjCnB,EAAE,0BACCkB,YAAA,aACDR,SAAA,eACFV,EAAE,0BAAFmB,KAA6BhB,QAAOC,YACpCJ,EAAE,0BACGkB,IAAAA,cAAY,WAGjBlB,EAAE,6BAAFK,MAAgCe,SACnCpB,EAAA,2BAAAG,OAAAC,SAjBLJ,EAAA,0BAmBAkB,YAAA,eA1EkCR,SAAA,aAsE1BV,EAAE,0BAA0BmB,KAAK,QAAS,YAOtDnB,EAAA,0BAAAgB,IAAA,cAAA,YAGQK,MAIAC,OAAAA,WAQZ,OAJQC,GAAOF,mBACVG,KAAA,eAzFLF,QAAA,cAqFYG,SAAS,EAOdC,QAPKD,KAOLrC,oBAAP,OACIL,eAAgBA","file":"../../scripts/layout/generic-nav-view.js","sourcesContent":["/** Real-time Communication feature **/\ndefine([\"mvc/ui/ui-modal\"], function(Modal) {\n    var GenericNavView = Backbone.View.extend({\n        initialize: function() {\n            this.modal = null;\n        },\n\n        /** makes bootstrap modal and iframe inside it */\n        makeModalIframe: function(e) {\n            // make modal\n            var host = window.Galaxy.config.communication_server_host,\n                port = window.Galaxy.config.communication_server_port,\n                username = escape(window.Galaxy.user.attributes.username),\n                persistent_communication_rooms = escape(window.Galaxy.config.persistent_communication_rooms),\n                query_string =\n                    \"?username=\" + username + \"&persistent_communication_rooms=\" + persistent_communication_rooms,\n                src = host + \":\" + port + query_string,\n                $el_chat_modal_header = null,\n                $el_chat_modal_body = null,\n                iframe_template = '<iframe class=\"f-iframe fade in communication-iframe\" src=\"' + src + '\"> </iframe>',\n                header_template =\n                    '<i class=\"fa fa-comment\" aria-hidden=\"true\" title=\"Communicate with other users\"></i>' +\n                    '<i class=\"fa fa-expand expand-compress-modal\" aria-hidden=\"true\" title=\"Maximize\"></i>' +\n                    '<i class=\"fa fa-times close-modal\" aria-hidden=\"true\" title=\"Close\"></i>',\n                frame_height = 350,\n                frame_width = 600,\n                class_names = \"ui-modal chat-modal\";\n\n            // deletes the chat modal if already present and create one\n            if ($(\".chat-modal\").length > 0) {\n                $(\".chat-modal\").remove();\n            }\n            // creates a modal\n            GenericNavView.modal = new Modal.View({\n                body: iframe_template,\n                height: frame_height,\n                width: frame_width,\n                closing_events: true,\n                title_separator: false,\n                cls: class_names\n            });\n\n            // shows modal\n            GenericNavView.modal.show();\n            $el_chat_modal_header = $(\".chat-modal .modal-header\");\n            $el_chat_modal_body = $(\".chat-modal .modal-body\");\n            // adjusts the css of bootstrap modal for chat\n            $el_chat_modal_header.addClass(\"modal-header-body\");\n            $el_chat_modal_body.addClass(\"modal-header-body\");\n            $el_chat_modal_header.find(\"h4\").remove();\n            $el_chat_modal_header.removeAttr(\"min-height padding border\");\n            $el_chat_modal_header.append(header_template);\n            // click event of the close button for chat\n            $(\".close-modal\").click(function(e) {\n                $(\".chat-modal\").css(\"display\", \"none\");\n            });\n            // click event of expand and compress icon\n            $(\".expand-compress-modal\").click(function(e) {\n                if ($(\".expand-compress-modal\").hasClass(\"fa-expand\")) {\n                    $(\".chat-modal .modal-dialog\").width(\"1000px\");\n                    $(\".chat-modal .modal-body\").height(\"575px\");\n                    $(\".expand-compress-modal\")\n                        .removeClass(\"fa-expand\")\n                        .addClass(\"fa-compress\");\n                    $(\".expand-compress-modal\").attr(\"title\", \"Minimize\");\n                    $(\".expand-compress-modal\").css(\"margin-left\", \"96.2%\");\n                } else {\n                    $(\".chat-modal .modal-dialog\").width(frame_width + \"px\");\n                    $(\".chat-modal .modal-body\").height(frame_height + \"px\");\n                    $(\".expand-compress-modal\")\n                        .removeClass(\"fa-compress\")\n                        .addClass(\"fa-expand\");\n                    $(\".expand-compress-modal\").attr(\"title\", \"Maximize\");\n                    $(\".expand-compress-modal\").css(\"margin-left\", \"93.2%\");\n                }\n            });\n            return this;\n        },\n\n        /**renders the chat icon as a nav item*/\n        render: function() {\n            var self = this,\n                navItem = {};\n            navItem = {\n                id: \"show-chat-online\",\n                icon: \"fa-comment-o\",\n                tooltip: \"Chat online\",\n                visible: false,\n                onclick: self.makeModalIframe\n            };\n            return navItem;\n        }\n    });\n\n    return {\n        GenericNavView: GenericNavView\n    };\n});\n"]}