{"version":3,"sources":["ui/mode-button.js"],"names":["factory","define","amd","jQuery","ModeButton","element","options","this","currModeIndex","prototype","DATA_KEY","switchModesOnClick","_init","$element","$","defaults","modes","Error","extend","modeButton","click","event","callModeFn","_incModeIndex","html","_getModeIndex","modeKey","i","length","mode","_setModeByIndex","index","newMode","currentMode","current","getMode","hasMode","err","setMode","reset","initialMode","modeFn","onclick","type","get","fn","map","$this","data","button","fnName","apply","makeArray","arguments","slice"],"mappings":"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","file":"../../scripts/ui/mode-button.js","sourcesContent":["// from: https://raw.githubusercontent.com/umdjs/umd/master/jqueryPlugin.js\n// Uses AMD or browser globals to create a jQuery plugin.\n(function(factory) {\n    if (typeof define === \"function\" && define.amd) {\n        //TODO: So...this turns out to be an all or nothing thing. If I load jQuery in the define below, it will\n        //  (of course) wipe the old jquery *and all the plugins loaded into it*. So the define below *is still\n        //  relying on jquery being loaded globally* in order to preserve plugins.\n        define([], factory);\n    } else {\n        // Browser globals\n        factory(jQuery);\n    }\n})(function() {\n    /** Multi 'mode' button (or any element really) that changes the html\n     *      contents of itself when clicked. Pass in an ordered list of\n     *      objects with 'html' and (optional) onclick functions.\n     *\n     *      When clicked in a particular node, the onclick function will\n     *      be called (with the element as this) and the element will\n     *      switch to the next mode, replacing its html content with\n     *      that mode's html.\n     *\n     *      If there is no next mode, the element will switch back to\n     *      the first mode.\n     * @example:\n     *     $( '.myElement' ).modeButton({\n     *         modes : [\n     *             {\n     *                 mode: 'bler',\n     *                 html: '<h5>Bler</h5>',\n     *                 onclick : function(){\n     *                     $( 'body' ).css( 'background-color', 'red' );\n     *                 }\n     *             },\n     *             {\n     *                 mode: 'bloo',\n     *                 html: '<h4>Bloo</h4>',\n     *                 onclick : function(){\n     *                     $( 'body' ).css( 'background-color', 'blue' );\n     *                 }\n     *             },\n     *             {\n     *                 mode: 'blah',\n     *                 html: '<h3>Blah</h3>',\n     *                 onclick : function(){\n     *                     $( 'body' ).css( 'background-color', 'grey' );\n     *                 }\n     *             },\n     *         ]\n     *     });\n     *     $( '.myElement' ).modeButton( 'callModeFn', 'bler' );\n     */\n    /** constructor */\n    function ModeButton(element, options) {\n        this.currModeIndex = 0;\n        return this._init(element, options);\n    }\n\n    /** html5 data key to store this object inside an element */\n    ModeButton.prototype.DATA_KEY = \"mode-button\";\n    /** default options */\n    ModeButton.prototype.defaults = {\n        switchModesOnClick: true\n    };\n\n    // ---- private interface\n    /** set up options, intial mode, and the click handler */\n    ModeButton.prototype._init = function _init(element, options) {\n        //console.debug( 'ModeButton._init:', element, options );\n        options = options || {};\n        this.$element = $(element);\n        this.options = $.extend(true, {}, this.defaults, options);\n        if (!options.modes) {\n            throw new Error('ModeButton requires a \"modes\" array');\n        }\n\n        var modeButton = this;\n        this.$element.click(function _ModeButtonClick(event) {\n            // call the curr mode fn\n            modeButton.callModeFn();\n            // inc the curr mode index\n            if (modeButton.options.switchModesOnClick) {\n                modeButton._incModeIndex();\n            }\n            // set the element html\n            $(this).html(modeButton.options.modes[modeButton.currModeIndex].html);\n        });\n        return this.reset();\n    };\n    /** increment the mode index to the next in the array, looping back to zero if at the last */\n    ModeButton.prototype._incModeIndex = function _incModeIndex() {\n        this.currModeIndex += 1;\n        if (this.currModeIndex >= this.options.modes.length) {\n            this.currModeIndex = 0;\n        }\n        return this;\n    };\n    /** get the mode index in the modes array for the given key (mode name) */\n    ModeButton.prototype._getModeIndex = function _getModeIndex(modeKey) {\n        for (var i = 0; i < this.options.modes.length; i += 1) {\n            if (this.options.modes[i].mode === modeKey) {\n                return i;\n            }\n        }\n        throw new Error(\"mode not found: \" + modeKey);\n    };\n    /** set the current mode to the one with the given index and set button html */\n    ModeButton.prototype._setModeByIndex = function _setModeByIndex(index) {\n        var newMode = this.options.modes[index];\n        if (!newMode) {\n            throw new Error(\"mode index not found: \" + index);\n        }\n        this.currModeIndex = index;\n        if (newMode.html) {\n            this.$element.html(newMode.html);\n        }\n        return this;\n    };\n\n    // ---- public interface\n    /** get the current mode object (not just the mode name) */\n    ModeButton.prototype.currentMode = function currentMode() {\n        return this.options.modes[this.currModeIndex];\n    };\n    /** return the mode key of the current mode */\n    ModeButton.prototype.current = function current() {\n        // sugar for returning mode name\n        return this.currentMode().mode;\n    };\n    /** get the mode with the given modeKey or the current mode if modeKey is undefined */\n    ModeButton.prototype.getMode = function getMode(modeKey) {\n        if (!modeKey) {\n            return this.currentMode();\n        }\n        return this.options.modes[this._getModeIndex(modeKey)];\n    };\n    /** T/F if the button has the given mode */\n    ModeButton.prototype.hasMode = function hasMode(modeKey) {\n        try {\n            return !!this.getMode(modeKey);\n        } catch (err) {}\n        return false;\n    };\n    /** set the current mode to the mode with the given name */\n    ModeButton.prototype.setMode = function setMode(modeKey) {\n        return this._setModeByIndex(this._getModeIndex(modeKey));\n    };\n    /** reset to the initial mode */\n    ModeButton.prototype.reset = function reset() {\n        this.currModeIndex = 0;\n        if (this.options.initialMode) {\n            this.currModeIndex = this._getModeIndex(this.options.initialMode);\n        }\n        return this._setModeByIndex(this.currModeIndex);\n    };\n    /** manually call the click handler of the given mode */\n    ModeButton.prototype.callModeFn = function callModeFn(modeKey) {\n        var modeFn = this.getMode(modeKey).onclick;\n        if (modeFn && $.type(modeFn === \"function\")) {\n            // call with the element as context (std jquery pattern)\n            return modeFn.call(this.$element.get(0));\n        }\n        return undefined;\n    };\n\n    // as jq plugin\n    $.fn.modeButton = function $modeButton(options) {\n        if (!this.length) {\n            return this;\n        }\n\n        //TODO: does map still work with jq multi selection (i.e. $( '.class-for-many-btns' ).modeButton)?\n        if ($.type(options) === \"object\") {\n            return this.map(function() {\n                var $this = $(this);\n                $this.data(\"mode-button\", new ModeButton($this, options));\n                return this;\n            });\n        }\n\n        var $first = $(this[0]),\n            button = $first.data(\"mode-button\");\n\n        if (!button) {\n            throw new Error(\"modeButton needs an options object or string name of a function\");\n        }\n\n        if (button && $.type(options) === \"string\") {\n            var fnName = options;\n            if (button && $.type(button[fnName]) === \"function\") {\n                return button[fnName].apply(button, $.makeArray(arguments).slice(1));\n            }\n        }\n        return button;\n    };\n});\n"]}