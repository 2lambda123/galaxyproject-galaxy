{"version":3,"sources":["mvc/workflow/workflow-view-data.js"],"names":["define","Globals","DataInputView","Backbone","View","extend","className","options","this","input","initialize","nodeView","terminalElement","label","$el","skipResize","css","left","position","display","el","updateMaxWidth","outerWidth","$","DataOutputView","output","name","node","indexOf","extensions","isInput","join","calloutView","type","OutputCalloutView","append","hoverImage","resetImage","top","detach","redrawWorkflowOutput","tagName","view","outputName","isWorkflowOutput","Galaxy","root","workflow","has_changes","canvas_manager","removeWorkflowOutput","attr","addWorkflowOutput","draw_overview","tooltip","delay","title","right","show"],"mappings":"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","file":"../../../scripts/mvc/workflow/workflow-view-data.js","sourcesContent":["define([\"mvc/workflow/workflow-globals\"], function(Globals) {\n    var DataInputView = Backbone.View.extend({\n        className: \"form-row dataRow input-data-row\",\n\n        initialize: function(options) {\n            this.input = options.input;\n            this.nodeView = options.nodeView;\n            this.terminalElement = options.terminalElement;\n\n            this.$el.attr(\"name\", this.input.name).html(this.input.label);\n\n            if (!options.skipResize) {\n                this.$el.css({\n                    position: \"absolute\",\n                    left: -1000,\n                    top: -1000,\n                    display: \"none\"\n                });\n                $(\"body\").append(this.el);\n                this.nodeView.updateMaxWidth(this.$el.outerWidth());\n                this.$el.css({\n                    position: \"\",\n                    left: \"\",\n                    top: \"\",\n                    display: \"\"\n                });\n                this.$el.remove();\n            }\n        }\n    });\n\n    var DataOutputView = Backbone.View.extend({\n        className: \"form-row dataRow\",\n\n        initialize: function(options) {\n            this.output = options.output;\n            this.terminalElement = options.terminalElement;\n            this.nodeView = options.nodeView;\n\n            var output = this.output;\n            var label = output.name;\n            var node = this.nodeView.node;\n\n            var isInput = output.extensions.indexOf(\"input\") >= 0 || output.extensions.indexOf(\"input_collection\") >= 0;\n            if (!isInput) {\n                label = label + \" (\" + output.extensions.join(\", \") + \")\";\n            }\n            this.$el.html(label);\n            this.calloutView = null;\n            if ([\"tool\", \"subworkflow\"].indexOf(node.type) >= 0) {\n                var calloutView = new OutputCalloutView({\n                    label: label,\n                    output: output,\n                    node: node\n                });\n                this.calloutView = calloutView;\n                this.$el.append(calloutView.el);\n                this.$el.hover(\n                    function() {\n                        calloutView.hoverImage();\n                    },\n                    function() {\n                        calloutView.resetImage();\n                    }\n                );\n            }\n            this.$el.css({\n                position: \"absolute\",\n                left: -1000,\n                top: -1000,\n                display: \"none\"\n            });\n            $(\"body\").append(this.el);\n            this.nodeView.updateMaxWidth(this.$el.outerWidth() + 17);\n            this.$el\n                .css({\n                    position: \"\",\n                    left: \"\",\n                    top: \"\",\n                    display: \"\"\n                })\n                .detach();\n        },\n        redrawWorkflowOutput: function() {\n            if (this.calloutView) {\n                this.calloutView.resetImage();\n            }\n        }\n    });\n\n    var OutputCalloutView = Backbone.View.extend({\n        tagName: \"div\",\n\n        initialize: function(options) {\n            this.label = options.label;\n            this.node = options.node;\n            this.output = options.output;\n\n            var view = this;\n            var node = this.node;\n            this.$el\n                .attr(\"class\", \"callout \" + this.label)\n                .css({ display: \"none\" })\n                .append(\n                    $(\"<div class='buttons'></div>\").append(\n                        $(\"<img/>\")\n                            .attr(\"src\", Galaxy.root + \"static/images/fugue/asterisk-small-outline.png\")\n                            .click(function() {\n                                var outputName = view.output.name;\n                                if (node.isWorkflowOutput(outputName)) {\n                                    node.removeWorkflowOutput(outputName);\n                                    view\n                                        .$(\"img\")\n                                        .attr(\"src\", Galaxy.root + \"static/images/fugue/asterisk-small-outline.png\");\n                                } else {\n                                    node.addWorkflowOutput(outputName);\n                                    view.$(\"img\").attr(\"src\", Galaxy.root + \"static/images/fugue/asterisk-small.png\");\n                                }\n                                Globals.workflow.has_changes = true;\n                                Globals.canvas_manager.draw_overview();\n                            })\n                    )\n                )\n                .tooltip({\n                    delay: 500,\n                    title: \"Mark dataset as a workflow output. All unmarked datasets will be hidden.\"\n                });\n\n            this.$el.css({\n                top: \"50%\",\n                margin: \"-8px 0px 0px 0px\",\n                right: 8\n            });\n            this.$el.show();\n            this.resetImage();\n        },\n\n        resetImage: function() {\n            if (!this.node.isWorkflowOutput(this.output.name)) {\n                this.$(\"img\").attr(\"src\", Galaxy.root + \"static/images/fugue/asterisk-small-outline.png\");\n            } else {\n                this.$(\"img\").attr(\"src\", Galaxy.root + \"static/images/fugue/asterisk-small.png\");\n            }\n        },\n\n        hoverImage: function() {\n            this.$(\"img\").attr(\"src\", Galaxy.root + \"static/images/fugue/asterisk-small-yellow.png\");\n        }\n    });\n\n    return {\n        DataInputView: DataInputView,\n        DataOutputView: DataOutputView\n    };\n});\n"]}