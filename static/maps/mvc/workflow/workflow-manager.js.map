{"version":3,"file":"workflow-manager.js","sources":["../../../src/mvc/workflow/workflow-manager.js"],"names":["define","Connector","Toastr","Workflow","app","canvas_container","this","id_counter","nodes","name","has_changes","active_form_has_changes","nodeLabels","workflowOutputLabels","$","extend","prototype","canLabelNodeWith","label","registerNodeLabel","unregisterNodeLabel","updateNodeLabel","fromLabel","toLabel","warning","attemptUpdateNodeLabel","node","setLabel","canLabelOutputWith","registerOutputLabel","unregisterOutputLabel","updateOutputLabel","attemptUpdateOutputLabel","outputName","labelWorkflowOutput","nodeView","redrawWorkflowOutputs","create_node","type","title_text","content_id","prebuildNode","add_node","fit_canvas_to_nodes","canvas_manager","draw_overview","activate_node","id","element","attr","workflow","remove_node","active_node","clear_active_node","remove_all","wf","each","k","v","destroy","rectify_workflow_outputs","using_workflow_outputs","has_existing_pjas","workflow_outputs","length","post_job_actions","pja_id","pja","action_type","self","node_changed","pjas_to_rem","push","i","pja_name","output_terminals","ot_id","ot","create_pja","isWorkflowOutput","output_name","action_arguments","reload_active_node","to_simple","input_connections","input_terminals","t","cons","connectors","c","handle1","con_dict","input_subworkflow_step_id","attributes","input","undefined","act","node_data","tool_state","errors","position","annotation","uuid","steps","from_simple","data","initialImport_","initialImport","offset","Object","keys","max_id","step","workflow_output","init_field_data","css","top","left","parseInt","Math","max","isArray","l","x","other_node","connect","redraw","addWorkflowOutput","callout","find","Galaxy","root","check_changes_in_active_form","submit","make_inactive","showAttributes","showForm","config_form","make_active","force","showWorkflowParameters","layout","n_pred","successors","j","other","node_ids_by_level","level_parents","pred_k","sk","all_nodes","h_pad","v_pad","ids","sort","a","b","max_width","width","height","_","bounds_for_all_nodes","p","xmin","xmax","ymin","ymax","e","min","round_up","n","ceil","fix_delta","new_pos","bounds","parent","xmin_delta","ymin_delta","children"],"mappings":"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"}