{"version":3,"sources":["mvc/ui/ui-portlet.js"],"names":["define","Utils","Ui","View","Backbone","extend","visible","this","initialize","self","options","model","uid","cls","title","icon","buttons","body","scrollable","nopadding","operations","collapsible","collapsible_button","collapsed","onchange_title","setElement","_template","$body","$","$title_text","$title_icon","$header","$content","$backdrop","$buttons","$operations","get","append","ButtonIcon","tooltip","onclick","render","attributes","$el","each","id","html","_","removeClass","addClass","off","on","expand","prop","empty","new_title","item","show","name","header","fadeIn","hide","enableButton","find","disableButton","hideOperation","showOperation","setOperation","callback","collapse","height","setIcon","enable","disable"],"mappings":"aAAAA,QAAQ,cAAe,kBAAmB,SAASC,EAAOC,GAsOtD,OACIC,KAtOOC,SAASD,KAAKE,QADrBC,SAAA,EACAH,WAAOC,SAAcC,GACrBC,IAAAA,EAD4BC,KAE5BC,KAAAA,MACQC,GAAJC,EAAAC,OACA,IAAKA,SACAD,OAEOT,GAAAA,EAAAW,MACJC,IAAK,aACLC,MAHe,GAIfC,KAJe,GAKfC,QALe,KAMfC,KANe,KAOfC,YAPe,EAQfC,WAAW,EACXC,WATe,KAUfC,aAAa,EACbC,oBAAoB,EACpBC,WAAW,EACXC,eAAgB,OACbd,IAAAA,GACXH,KAAKkB,WAAWlB,KAAKmB,aAGrBnB,KAAKoB,MAAQpB,KAAKqB,EAAE,iBACpBrB,KAAKsB,YAActB,KAAKqB,EAAE,uBAC1BrB,KAAKuB,YAAcvB,KAAKqB,EAAE,uBAC1BrB,KAAKwB,QAAUxB,KAAKqB,EAAE,mBACtBrB,KAAKyB,SAAWzB,KAAKqB,EAAE,oBACvBrB,KAAK0B,UAAY1B,KAAKqB,EAAE,qBACxBrB,KAAK2B,SAAW3B,KAAKqB,EAAE,oBACvBrB,KAAK4B,YAAc5B,KAAKqB,EAAE,uBAG1BrB,KAAKI,MAAMyB,IAAI,SAAW7B,KAAK8B,OAAO9B,KAAKI,MAAMyB,IAAI,SAGrD7B,KAAKe,mBAAqB,IAAIpB,EAAGoC,YAC7BvB,KAAM,SACNwB,QAAS,kBACT1B,IAAK,uBACL2B,QAAS,WACL/B,EAAKA,EAAKc,UAAY,SAAW,iBAGzChB,KAAKkC,UAGTA,OAAQ,WACJ,IAAIhC,EAAOF,KACPG,EAAUH,KAAKI,MAAM+B,WAsE7B,OArEInC,KAAKoC,IAIAZ,cACAF,SAAAA,EAAiBnB,KACpBkC,KAAM,KAAKZ,EAAUa,IACnBF,KAAAA,QAAIjC,EAAQS,MAAY,OAApB,UACPZ,KAFDsB,YAAAiB,KAAApC,EAAAI,OAAAiC,EAAEH,MAAMrC,KAAKyB,SAAUzB,KAAKoB,OAAQ,SAASgB,GAI7CA,EAAAjC,EAAAS,UAAA,WAAA,eAAA,gBAQIT,EAAKoB,KACRvB,KAAAuB,YANQkB,cAQTC,SAAA,yBACKpB,SAAYnB,EAAQW,MACrBX,OAEID,KAAAA,YAAUc,OAHlBhB,KAAKsB,YAAYnB,EAAQW,YAAc,WAAa,eAAe,4BAA4B6B,MAQ/FxC,EAAAW,cACAd,KAAKsB,YAALsB,GAAsB,QAAtB,WACQ3B,EAAAA,EAAAA,UACJ,SAAKK,gBAEGnB,EAAAA,UAAQc,KAAAA,WAARjB,KAAA6C,UAIZ7C,KAAAsB,YAAAwB,KAAA,YAAA3C,EAAAc,gBACAd,EAAIA,gBACAH,KAAK2B,YAASoB,oBACZV,UAAUjC,SAAU4C,GAClBC,EAASH,eAATE,MAKP7C,EAAAM,SAPGT,KAAK2B,SAASoB,QAAQG,OAS1B7B,EAAAgB,KAAArC,KAAAI,MAAAyB,IAAA,WAAA,SAAAsB,EAAAF,GACKrB,EAAAA,IAAYmB,KAAjB,KAAAI,GACIhD,EAAQY,SAAAA,OAAAA,EAAoBqB,QAG5BjC,KAAAA,SAAQU,OAIPb,KAHD4B,YAAAmB,MAIH5C,EAAAY,oBACDf,KAAO4B,YAAPE,OAAA9B,KAAAe,mBAAAqB,KANIjC,EAAQU,YAShBQ,EAAAgB,KAAAlC,EAAAU,WAAA,SAAAsC,EAAAF,GACQA,EAAAb,IAAAU,KAASV,KAAKe,GACb/B,EAAMU,YAAXA,OAAAmB,EAAAb,OAGJpC,MAJA8B,OAAQ,SAASM,GASjBpC,KAAAoB,MAAAU,OAAAM,IAJAW,MAAO,WASP/C,KAAAoB,MAAA2B,SAJAK,OAAQ,WASR,OAAApD,KAAAwB,SAICd,KA3I2B,WAoIxB,OAAOV,KAAKoB,OAYZ8B,KAAA,WAhJwBlD,KAAAD,SAAA,EA0IxBC,KAAKoC,IAAIiB,OAAO,SAYnBC,KAtJ2B,WA+IxBtD,KAAKD,SAAU,EASnBC,KAAAoC,IAAAkB,QAJAC,aAAc,SAASjB,GASvBtC,KAAA2B,SAAA6B,KAAA,IAAAlB,GAAAQ,KAAA,YAAA,IAJAW,cAAe,SAASnB,GASxBtC,KAAA2B,SAAA6B,KAAA,IAAAlB,GAAAQ,KAAA,YAAA,IAJAY,cAAe,SAASpB,GASxBtC,KAAA4B,YAAA4B,KAAA,IAAAlB,GAAAgB,QAJAK,cAAe,SAASrB,GAYxBtC,KAAA4B,YAAA4B,KAAA,IAAAlB,GAAAY,QAICU,aAnL2B,SAAAtB,EAAAuB,GAyKxB7D,KAAK4B,YAYT4B,KAAA,IAAAlB,GACAwB,IAAU,SACD9C,GAAAA,QAAY6C,IAIpBtD,MA3L2B,SAAAyC,GA6L5B,OAZIA,GAAahD,KAAKsB,YAAYiB,KAAKS,GAYvChD,KAAAsB,YAAAiB,QAIIuB,SAAK1C,WACLpB,KAAKe,WAAAA,EAlMmBf,KAAAyB,SAAAsC,OAAA,MAyLxB/D,KAAKoB,MAAMkC,OAYftD,KAAAe,mBAAAiD,QAAA,iBAPAnB,OAAQ,WAYR7C,KAAAgB,WAAA,EACAiD,KAAQxC,SAAAsC,OAAA,QACJ/D,KAAK0B,MAAAA,OAAU4B,QA5MStD,KAAAe,mBAAAiD,QAAA,WAmO3BE,QAAA,WAnOLlE,KAAA0B,UAAAwB,QADJe,OAAA,WA6MYjE,KAAK0B,UAAU4B,QAGnBnC,UAAW,WACP,OAAOE,EAAE,UACJS,OACGT,EAAE,UACGqB,SAAS,kBACTZ,OAAOT,EAAE,UAAUqB,SAAS,uBAC5BZ,OACGT,EAAE,UACGqB,SAAS,iBACTZ,OAAOT,EAAE,QAAQqB,SAAS,uBAC1BZ,OAAOT,EAAE,WAAWqB,SAAS,yBAG7CZ,OACGT,EAAE,UACGqB,SAAS,mBACTZ,OAAOT,EAAE,UAAUqB,SAAS,iBAC5BZ,OAAOT,EAAE,UAAUqB,SAAS,qBAEpCZ,OAAOT,EAAE,UAAUqB,SAAS","file":"../../../scripts/mvc/ui/ui-portlet.js","sourcesContent":["define([\"utils/utils\", \"mvc/ui/ui-misc\"], function(Utils, Ui) {\n    var View = Backbone.View.extend({\n        visible: false,\n        initialize: function(options) {\n            var self = this;\n            this.model =\n                (options && options.model) ||\n                new Backbone.Model({\n                    id: Utils.uid(),\n                    cls: \"ui-portlet\",\n                    title: \"\",\n                    icon: \"\",\n                    buttons: null,\n                    body: null,\n                    scrollable: true,\n                    nopadding: false,\n                    operations: null,\n                    collapsible: false,\n                    collapsible_button: false,\n                    collapsed: false,\n                    onchange_title: null\n                }).set(options);\n            this.setElement(this._template());\n\n            // link all dom elements\n            this.$body = this.$(\".portlet-body\");\n            this.$title_text = this.$(\".portlet-title-text\");\n            this.$title_icon = this.$(\".portlet-title-icon\");\n            this.$header = this.$(\".portlet-header\");\n            this.$content = this.$(\".portlet-content\");\n            this.$backdrop = this.$(\".portlet-backdrop\");\n            this.$buttons = this.$(\".portlet-buttons\");\n            this.$operations = this.$(\".portlet-operations\");\n\n            // add body to component list\n            this.model.get(\"body\") && this.append(this.model.get(\"body\"));\n\n            // add icon for collapsible option\n            this.collapsible_button = new Ui.ButtonIcon({\n                icon: \"fa-eye\",\n                tooltip: \"Collapse/Expand\",\n                cls: \"ui-button-icon-plain\",\n                onclick: function() {\n                    self[self.collapsed ? \"expand\" : \"collapse\"]();\n                }\n            });\n            this.render();\n        },\n\n        render: function() {\n            var self = this;\n            var options = this.model.attributes;\n            this.$el\n                .removeClass()\n                .addClass(options.cls)\n                .attr(\"id\", options.id);\n            this.$header[options.title ? \"show\" : \"hide\"]();\n            this.$title_text.html(options.title);\n            _.each([this.$content, this.$body], function($el) {\n                $el[options.nopadding ? \"addClass\" : \"removeClass\"](\"no-padding\");\n            });\n\n            // render title icon\n            if (options.icon) {\n                this.$title_icon\n                    .removeClass()\n                    .addClass(\"portlet-title-icon fa\")\n                    .addClass(options.icon)\n                    .show();\n            } else {\n                this.$title_icon.hide();\n            }\n\n            // make portlet collapsible\n            this.$title_text[options.collapsible ? \"addClass\" : \"removeClass\"](\"no-highlight collapsible\").off();\n            if (options.collapsible) {\n                this.$title_text.on(\"click\", function() {\n                    self[self.collapsed ? \"expand\" : \"collapse\"]();\n                });\n                options.collapsed ? this.collapse() : this.expand();\n            }\n\n            // allow title editing\n            this.$title_text.prop(\"disabled\", !options.onchange_title);\n            options.onchange_title &&\n                this.$title_text.make_text_editable({\n                    on_finish: function(new_title) {\n                        options.onchange_title(new_title);\n                    }\n                });\n\n            // render buttons\n            if (options.buttons) {\n                this.$buttons.empty().show();\n                $.each(this.model.get(\"buttons\"), function(name, item) {\n                    item.$el.prop(\"id\", name);\n                    self.$buttons.append(item.$el);\n                });\n            } else {\n                this.$buttons.hide();\n            }\n\n            // render operations\n            this.$operations.empty;\n            if (options.collapsible_button) {\n                this.$operations.append(this.collapsible_button.$el);\n            }\n            if (options.operations) {\n                $.each(options.operations, function(name, item) {\n                    item.$el.prop(\"id\", name);\n                    self.$operations.append(item.$el);\n                });\n            }\n            return this;\n        },\n\n        /** Append new doms to body */\n        append: function($el) {\n            this.$body.append($el);\n        },\n\n        /** Remove all content */\n        empty: function() {\n            this.$body.empty();\n        },\n\n        /** Return header element */\n        header: function() {\n            return this.$header;\n        },\n\n        /** Return body element */\n        body: function() {\n            return this.$body;\n        },\n\n        /** Show portlet */\n        show: function() {\n            this.visible = true;\n            this.$el.fadeIn(\"fast\");\n        },\n\n        /** Hide portlet */\n        hide: function() {\n            this.visible = false;\n            this.$el.hide();\n        },\n\n        /** Enable a particular button */\n        enableButton: function(id) {\n            this.$buttons.find(\"#\" + id).prop(\"disabled\", false);\n        },\n\n        /** Disable a particular button */\n        disableButton: function(id) {\n            this.$buttons.find(\"#\" + id).prop(\"disabled\", true);\n        },\n\n        /** Hide a particular operation */\n        hideOperation: function(id) {\n            this.$operations.find(\"#\" + id).hide();\n        },\n\n        /** Show a particular operation */\n        showOperation: function(id) {\n            this.$operations.find(\"#\" + id).show();\n        },\n\n        /** Replaces the event callback of an existing operation */\n        setOperation: function(id, callback) {\n            this.$operations\n                .find(\"#\" + id)\n                .off(\"click\")\n                .on(\"click\", callback);\n        },\n\n        /** Change title */\n        title: function(new_title) {\n            new_title && this.$title_text.html(new_title);\n            return this.$title_text.html();\n        },\n\n        /** Collapse portlet */\n        collapse: function() {\n            this.collapsed = true;\n            this.$content.height(\"0%\");\n            this.$body.hide();\n            this.collapsible_button.setIcon(\"fa-eye-slash\");\n        },\n\n        /** Expand portlet */\n        expand: function() {\n            this.collapsed = false;\n            this.$content.height(\"100%\");\n            this.$body.fadeIn(\"fast\");\n            this.collapsible_button.setIcon(\"fa-eye\");\n        },\n\n        /** Disable content access */\n        disable: function() {\n            this.$backdrop.show();\n        },\n\n        /** Enable content access */\n        enable: function() {\n            this.$backdrop.hide();\n        },\n\n        _template: function() {\n            return $(\"<div/>\")\n                .append(\n                    $(\"<div/>\")\n                        .addClass(\"portlet-header\")\n                        .append($(\"<div/>\").addClass(\"portlet-operations\"))\n                        .append(\n                            $(\"<div/>\")\n                                .addClass(\"portlet-title\")\n                                .append($(\"<i/>\").addClass(\"portlet-title-icon\"))\n                                .append($(\"<span/>\").addClass(\"portlet-title-text\"))\n                        )\n                )\n                .append(\n                    $(\"<div/>\")\n                        .addClass(\"portlet-content\")\n                        .append($(\"<div/>\").addClass(\"portlet-body\"))\n                        .append($(\"<div/>\").addClass(\"portlet-buttons\"))\n                )\n                .append($(\"<div/>\").addClass(\"portlet-backdrop\"));\n        }\n    });\n    return {\n        View: View\n    };\n});\n"]}