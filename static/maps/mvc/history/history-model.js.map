{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","HISTORY_PREFS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_active","contents_states","urlRoot","Galaxy","root","initialize","historyJSON","contentsJSON","options","this","logger","log","contents","HistoryContents","historyId","get","order","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","running","visibleAndUndeleted","searchAttributes","searchAliases","title","tag","_getSizeAndRunning","fetch","data","$","param","keys","refresh","self","lastUpdateTime","Date","allFetched","fetchUpdated","done","bind","checkForUpdates","_delayThenUpdate","setTimeout","delay","nonReadyContentCount","clearTimeout","parse","response","parsed","create_time","update_time","fetchWithContents","contentsOptions","view","pipe","history","fetchContents","prefs","HistoryPrefs","includeDeleted","show_deleted","includeHidden","show_hidden","fetchFirst","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","newHistory","setAsCurrent","xhr","getJSON","toString","_collectionSuper","PaginatedCollection","HistoryCollection","limitOnFirstFetch","limitPerFetch","models","currentHistoryId","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","_buildFetchFilters","superFilters","filters","comparators","clone","buildComparator","ascending","name-dsc","size","size-asc","sort","silent","currentHistory","unshift","create","hdas","historyOptions","collection"],"mappings":"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"}