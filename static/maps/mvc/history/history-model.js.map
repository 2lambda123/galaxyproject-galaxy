{"version":3,"sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","UTILS","BASE_MVC","_l","logNamespace","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","defaults","model_class","id","name","state","deleted","urlRoot","Galaxy","root","initialize","historyJSON","contentsJSON","options","this","logger","log","contents","HistoryContents","historyId","get","_setUpListeners","updateTimeoutId","on","model","xhr","msg","details","errorHandler","listenTo","trigger","apply","concat","jQuery","makeArray","arguments","newId","clearUpdateTimeout","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","contentsCount","reduce","values","memo","num","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","running","visibleAndUndeleted","searchAttributes","searchAliases","title","tag","_getSizeAndRunning","fetch","data","$","param","keys","refresh","self","lastUpdateTime","fetchUpdated","done","response","status","serverResponseDatetime","Date","getResponseHeader","err","checkForUpdates","_delayThenUpdate","setTimeout","delay","UPDATE_DELAY","historyData","clearTimeout","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","history","post","then","newHistory","setAsCurrent","getJSON","toString","getHistoryData","getHistory","ajax","isEmpty","empty","getContents","isFunction","detailIdsFn","hdcaDetailIds","v","join","df","Deferred","historyFn","contentsFn","historyXHR","json","notify","fail","message","reject","contentsXHR","resolve","ControlledFetchMixin","_buildFetchData","traditional","Collection","_fetchOptions","fetchDefaults","_fetchDefaults","pick","filters","has","_buildFetchFilters","filterMap","q","qv","each","k","push","HistoryCollection","DEFAULT_ORDER","sortOrders","update_time","getter","h","asc","update_time-asc","name-dsc","size","size-asc","models","includeDeleted","setOrder","order","currentHistoryId","allFetched","setUpListeners","url","view","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","sort","collection","sortOrder","isUndefined","comparator","a","b","fetchOptions","offset","limit","fetchData","numFetched","isArray","create","hdas","historyOptions","xhrOptions","unshift","silent","reset"],"mappings":"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","file":"history-model.js"}