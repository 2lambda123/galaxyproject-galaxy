{"version":3,"file":"history-view-edit.js","sources":["../../../src/mvc/history/history-view-edit.js"],"names":["define","HISTORY_VIEW","HISTORY_CONTENTS","STATES","HDA_MODEL","HDA_LI_EDIT","HDCA_LI_EDIT","TAGS","ANNOTATIONS","LIST_COLLECTION_CREATOR","PAIR_COLLECTION_CREATOR","LIST_OF_PAIRS_COLLECTION_CREATOR","faIconButton","PopupMenu","BASE_MVC","_l","_super","HistoryView","HistoryViewEdit","extend","HDAViewClass","HDAListItemEdit","HDCAViewClass","HDCAListItemEdit","initialize","attributes","prototype","call","this","tagsEditor","annotationEditor","purgeAllowed","annotationEditorShown","tagsEditorShown","_setUpListeners","panel","on","ev","data","dataDropped","dropTargetOff","_renderCounts","_setUpModelListeners","listenTo","model","updateHistoryDiskSize","_setUpCollectionListeners","collection","change:deleted","_handleItemDeletionChange","change:visible","_handleItemVisibleChange","change:purged","fetch","fetching-deleted","$","html","fetching-hidden","fetching-deleted-done fetching-hidden-done","_buildNewRender","$newRender","Galaxy","user","id","get","_renderTags","_renderAnnotation","renderItems","$whereTo","views","jQuery","$el","templates","counts","toJSON","find","$where","TagsEditor","el","onshowFirstTime","render","onshow","toggleHDATagEditors","fxSpeed","onhide","$activator","title","classes","faIcon","appendTo","AnnotationEditor","toggleHDAAnnotationEditors","_setUpBehaviors","isAnonymous","nameSelector","attr","tooltip","placement","make_text_editable","on_finish","newName","previousName","text","save","name","fail","previous","multiselectActions","actions","func","action","HistoryDatasetAssociation","hide","getSelectedModels","ajaxQueue","unhide","undelete","push","confirm","purge","concat","_collectionActions","createListCollection","done","refresh","createPairCollection","createListOfPairsCollection","_getItemViewOptions","options","_","hidden","itemModel","contentsShown","deleted","showDeleted","removeItemView","active","set","showHidden","showOrHide","speed","each","view","toggle","events","clone","click .show-selectors-btn","click .toggle-deleted-link","toggleShowDeleted","click .toggle-hidden-link","toggleShowHidden","dropTargetOn","dropTarget","dropHandlers","dragenter","bind","dragover","dragleave","drop","$dropTarget","_renderDropTarget","$list","before","_renderDropTargetHelp","evName","hasOwnProperty","remove","addClass","_dropHandlers","off","dropTargetToggle","preventDefault","stopPropagation","css","dataTransfer","originalEvent","dropEffect","getData","JSON","parse","err","warn","trigger","isObject","model_class","contents","copy","when","toString","countsTemplate","wrapTemplate"],"mappings":"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"}