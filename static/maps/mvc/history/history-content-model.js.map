{"version":3,"sources":["mvc/history/history-content-model.js"],"names":["define","STATES","BASE_MVC","_l","HistoryContentMixin","defaults","history_id","history_content_type","hid","visible","idAttribute","hidden","this","get","isVisible","includeDeleted","includeHidden","urlRoot","Galaxy","root","url","hide","options","save","jQuery","when","unhide","toString","join"],"mappings":"aAAAA,QAAQ,qBAAsB,eAAgB,sBAAuB,SAASC,EAAQC,EAAUC,GAAhG,OAwFQC,qBAhFAC,UADAC,WAAA,KAEIC,qBAAA,KAEAC,IAAA,KAEAC,SAAA,GAOJC,YAAA,UAOAC,OAAQ,WAFR,OAAAC,KAAAC,IAAA,YAYAC,UAAW,SAASC,EAAgBC,GAChC,IAAIF,GAAY,EAIhB,OAHKC,IAAmBH,KAAKC,IAAI,aAAcD,KAAKC,IAAI,YAF5DC,GAAW,GAEFC,GAADH,KAAoBC,IAAA,aACpBC,GAAY,GAEXE,GAMTC,QAAAC,OAAAC,KAAA,iBAGAF,IAAAA,WAII,IAAIG,EAFRR,KAAAK,QACKL,KAAAC,IAAA,cACGO,aAOJR,KAAOQ,IAAP,wBAxDkB,KAuDdR,KAAKC,IAAI,MAIjB,OAAAO,GAIKC,KAAA,SAAAC,GACD,OAAAV,KAAOC,IAAKU,WAGRX,KAAAW,MAAAd,SAAA,GAAkBa,GAnEJE,OAAAC,QAsEjBC,OAAA,SAAAJ,GACD,OAAAV,KAAOC,IAAKU,WAvEMC,OAAAC,OA0EtBb,KAAAW,MAAAd,SAAA,GAAAa,IA1EJK,SAAA,WA4EQ,OAAQf,KAAKC,IAAI,WAAYD,KAAKC,IAAI,OAAQD,KAAKC,IAAI,SAASe,KAAK","file":"../../../scripts/mvc/history/history-content-model.js","sourcesContent":["define([\"mvc/dataset/states\", \"mvc/base-mvc\", \"utils/localization\"], function(STATES, BASE_MVC, _l) {\n    \"use strict\";\n\n    //==============================================================================\n    /** @class Mixin for HistoryContents content (HDAs, HDCAs).\n */\n    var HistoryContentMixin = {\n        /** default attributes for a model */\n        defaults: {\n            /** parent (containing) history */\n            history_id: null,\n            /** some content_type (HistoryContents can contain mixed model classes) */\n            history_content_type: null,\n            /** indicating when/what order the content was generated in the context of the history */\n            hid: null,\n            /** whether the user wants the content shown (visible) */\n            visible: true\n        },\n\n        // ........................................................................ mixed content element\n        // In order to be part of a MIXED bbone collection, we can't rely on the id\n        //  (which may collide btwn models of different classes)\n        // Instead, use type_id which prefixes the history_content_type so the bbone collection can differentiate\n        idAttribute: \"type_id\",\n\n        // ........................................................................ common queries\n        /** the more common alias of visible */\n        hidden: function() {\n            return !this.get(\"visible\");\n        },\n\n        //TODO: remove\n        /** based on includeDeleted, includeHidden (gen. from the container control),\n     *      would this ds show in the list of ds's?\n     *  @param {Boolean} includeDeleted are we showing deleted hdas?\n     *  @param {Boolean} includeHidden are we showing hidden hdas?\n     */\n        isVisible: function(includeDeleted, includeHidden) {\n            var isVisible = true;\n            if (!includeDeleted && (this.get(\"deleted\") || this.get(\"purged\"))) {\n                isVisible = false;\n            }\n            if (!includeHidden && !this.get(\"visible\")) {\n                isVisible = false;\n            }\n            return isVisible;\n        },\n\n        // ........................................................................ ajax\n        //TODO?: these are probably better done on the leaf classes\n        /** history content goes through the 'api/histories' API */\n        urlRoot: Galaxy.root + \"api/histories/\",\n\n        /** full url spec. for this content */\n        url: function() {\n            var url =\n                this.urlRoot +\n                this.get(\"history_id\") +\n                \"/contents/\" +\n                this.get(\"history_content_type\") +\n                \"s/\" +\n                this.get(\"id\");\n            return url;\n        },\n\n        /** save this content as not visible */\n        hide: function(options) {\n            if (!this.get(\"visible\")) {\n                return jQuery.when();\n            }\n            return this.save({ visible: false }, options);\n        },\n        /** save this content as visible */\n        unhide: function(options) {\n            if (this.get(\"visible\")) {\n                return jQuery.when();\n            }\n            return this.save({ visible: true }, options);\n        },\n\n        // ........................................................................ misc\n        toString: function() {\n            return [this.get(\"type_id\"), this.get(\"hid\"), this.get(\"name\")].join(\":\");\n        }\n    };\n\n    //==============================================================================\n    return {\n        HistoryContentMixin: HistoryContentMixin\n    };\n});\n"]}