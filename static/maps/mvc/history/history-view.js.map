{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HISTORY_PREFS","HDA_LI","HDCA_LI","USER","ERROR_MODAL","faIconButton","BASE_MVC","_l","_super","ModelListPanel","HistoryView","extend","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","this","linkTarget","freeModel","model","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","render","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistory","historyId","contentsOptions","info","self","setModel","History","id","fetchWithContents","always","refreshContents","refresh","$","when","_setUpWebStorage","_setUpModelListeners","listenTo","change:id","_setUpCollectionListeners","collection","fetching-more","showContentsLoadingIndicator","fetching-more-done","hideContentsLoadingIndicator","storage","stopListening","HistoryPrefs","historyStorageKey","get","log","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","_buildNewRender","$newRender","_renderEmptyMessage","$whereTo","empty","active","$emptyMsg","$emptyMessage","append","show","searchFor","contents","haveSearchDetails","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","size","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","panel","hidden","isDeletedOrPurged","_getItemViewOptions","_","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","addExpanded","collapsed","removeExpanded","collapseAll","set","getSelectedModels","INFINITE_SCROLL_DEBOUNCE_MS","INFINITE_SCROLL_FETCH_THRESHOLD_PX","_setUpBehaviors","scrollHandler","debounce","bind","$scrollContainer","pxToBottom","_scrollDistanceToBottom","console","_fetching","isEmpty","panelStack","listenToOnce","bulkAppendItemViews","fetchMore","silent","useSync","$container","outerHeight","scrollTop","innerHeight","speed","isNumber","fxSpeed","is","hide","$indicator","stop","clearQueue","templates","contentsLoadingIndicator","insertAfter","slideDown","slideUp","duration","complete","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","store","undefined","includeDeleted","last","lastHid","fetch","jQuery","fetchDeleted","filters","hid-ge","done","renderItems","toggleShowHidden","includeHidden","fetchHidden","_firstSearch","inputSelector","initialContentsLength","searchItems","searchInput","progressivelyFetchDetails","progress","response","limit","offset","status","readyState","isString","message","errorModal","badGatewayErrorModal","ajaxErrorModal","clearMessages","ev","$target","isUndefined","$messages","children","currentTarget","fadeOut","scrollToHid","hid","scrollToItem","first","viewsWhereModel","toString","controlsTemplate","wrapTemplate","contentsLoadingIndicatorTemplate","controls"],"mappings":"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"}