{"version":3,"sources":["mvc/history/hda-li-edit.js"],"names":["define","DATASET_LI_EDIT","BASE_MVC","_l","_super","DatasetListItemEdit","className","prototype","_fetchModelDetails","inReadyState","view","model","hasDetails","fetch","silent","has","jQuery","when","keys","join","events","_","unhide","click .unhide-link","ev","this","toString","HDAListItemEdit","templates","warnings","extend","hidden","wrapTemplate","titleBar","HDA_LI","HDAListItemView"],"mappings":"aAAAA,QAAQ,8BAA+B,qBAAsB,eAAgB,sBAAuB,SAChGC,EADJD,EAMIE,EAFAC,GAKA,IAAIC,EAASH,EAAgBI,oBAKrBC,EAAkBC,EAAAA,QAElBD,UAAAF,EAAAG,UAAAD,UAAA,mBAKIE,mBAAeC,WACX,IAAAC,EAAOA,KADX,OAAIA,EAAKC,MAAMF,iBAAmBC,EAAKC,MAAMC,aAGzCF,EAAAC,MAAAE,OAAAC,QAAA,IAIYJ,EADYC,MAAAI,IAAA,cAQrBC,OAAOC,OANAP,EAAAC,MAAAE,OACFC,QAAA,EACAI,MAJRA,MAAA,aAAA,gBAAAC,KAAA,SAcAC,OAAAC,EAAKV,OAAMW,EAAAA,MAAXlB,EAAAG,UAAAa,SACAG,qBAAA,SAAAC,GA7B4B,OA8B/BC,KAAAd,MAAAW,UA9B+B,KAoChCI,SAAO,WArCnB,MAAA,oBAsCSD,KAAAd,MAAAc,KAAAd,MAAA,GAAA,cAtCT,OAsEA,OArBgBgB,EAAApB,UAAAqB,UAAA,WACA,IAAAC,EAAAR,EAAAS,UAAA1B,EAAAG,UAAAqB,UACGC,UANfE,OAAA7B,EAAA8B,cAiBSF,gCAELG,+CACAJ,EAAUA,gCAHd,6DAlBJ1B,EAAA,aAUgB,OAehB,SACO,WAAP,aARI,OAAOkB,EAAES,UAAW1B,EAAOG,UAAUqB,WAEjCK,SAAUC,EAAOC,gBAAgB5B,UAAUqB,UAAUK,SACrDJ,SAAUA,IAhBF,IAsBZF,gBAAiBA","file":"../../../scripts/mvc/history/hda-li-edit.js","sourcesContent":["define([\"mvc/dataset/dataset-li-edit\", \"mvc/history/hda-li\", \"mvc/base-mvc\", \"utils/localization\"], function(\n    DATASET_LI_EDIT,\n    HDA_LI,\n    BASE_MVC,\n    _l\n) {\n    \"use strict\";\n\n    //==============================================================================\n    var _super = DATASET_LI_EDIT.DatasetListItemEdit;\n    /** @class Editing view for HistoryDatasetAssociation.\n */\n    var HDAListItemEdit = _super.extend(\n        /** @lends HDAListItemEdit.prototype */ {\n            className: _super.prototype.className + \" history-content\",\n\n            /** In this override, only get details if in the ready state, get rerunnable if in other states.\n     *  Note: fetch with no 'change' event triggering to prevent automatic rendering.\n     */\n            _fetchModelDetails: function() {\n                var view = this;\n                if (view.model.inReadyState() && !view.model.hasDetails()) {\n                    return view.model.fetch({ silent: true });\n\n                    // special case the need for the rerunnable and creating_job attributes\n                    // needed for rendering re-run button on queued, running datasets\n                } else if (!view.model.has(\"rerunnable\")) {\n                    return view.model.fetch({\n                        silent: true,\n                        data: {\n                            // only fetch rerunnable and creating_job to keep overhead down\n                            keys: [\"rerunnable\", \"creating_job\"].join(\",\")\n                        }\n                    });\n                }\n                return jQuery.when();\n            },\n\n            /** event map */\n            events: _.extend(_.clone(_super.prototype.events), {\n                \"click .unhide-link\": function(ev) {\n                    this.model.unhide();\n                    return false;\n                }\n            }),\n\n            /** string rep */\n            toString: function() {\n                var modelString = this.model ? this.model + \"\" : \"(no model)\";\n                return \"HDAListItemEdit(\" + modelString + \")\";\n            }\n        }\n    );\n\n    // ............................................................................ TEMPLATES\n    /** underscore templates */\n    HDAListItemEdit.prototype.templates = (function() {\n        var warnings = _.extend({}, _super.prototype.templates.warnings, {\n            hidden: BASE_MVC.wrapTemplate(\n                [\n                    \"<% if( !dataset.visible ){ %>\",\n                    // add a link to unhide a dataset\n                    '<div class=\"hidden-msg warningmessagesmall\">',\n                    _l(\"This dataset has been hidden\"),\n                    '<br /><a class=\"unhide-link\" a href=\"javascript:void(0);\">',\n                    _l(\"Unhide it\"),\n                    \"</a>\",\n                    \"</div>\",\n                    \"<% } %>\"\n                ],\n                \"dataset\"\n            )\n        });\n\n        return _.extend({}, _super.prototype.templates, {\n            //NOTE: *steal* the HDAListItemView titleBar\n            titleBar: HDA_LI.HDAListItemView.prototype.templates.titleBar,\n            warnings: warnings\n        });\n    })();\n\n    //==============================================================================\n    return {\n        HDAListItemEdit: HDAListItemEdit\n    };\n});\n"]}